{"ast":null,"code":"'use strict';\n\nvar _asyncToGenerator = require(\"C:/Users/gkhakurel/Downloads/Poject-main/Poject-main/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar _regeneratorRuntime = require(\"C:/Users/gkhakurel/Downloads/Poject-main/Poject-main/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\");\n\nvar _asyncIterator = require(\"C:/Users/gkhakurel/Downloads/Poject-main/Poject-main/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/asyncIterator\");\n\nvar DirSharded = require('./dir-sharded');\n\nmodule.exports = /*#__PURE__*/function () {\n  var _flatToShard = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(child, dir, threshold, options) {\n    var newDir, parent;\n    return _regeneratorRuntime.wrap(function _callee$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            newDir = dir;\n\n            if (!(dir.flat && dir.directChildrenCount() >= threshold)) {\n              _context2.next = 5;\n              break;\n            }\n\n            _context2.next = 4;\n            return convertToShard(dir, options);\n\n          case 4:\n            newDir = _context2.sent;\n\n          case 5:\n            parent = newDir.parent;\n\n            if (!parent) {\n              _context2.next = 13;\n              break;\n            }\n\n            if (!(newDir !== dir)) {\n              _context2.next = 11;\n              break;\n            }\n\n            if (child) {\n              child.parent = newDir;\n            }\n\n            _context2.next = 11;\n            return parent.put(newDir.parentKey, newDir);\n\n          case 11:\n            if (!parent) {\n              _context2.next = 13;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", flatToShard(newDir, parent, threshold, options));\n\n          case 13:\n            return _context2.abrupt(\"return\", newDir);\n\n          case 14:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  function flatToShard(_x, _x2, _x3, _x4) {\n    return _flatToShard.apply(this, arguments);\n  }\n\n  return flatToShard;\n}();\n\nfunction convertToShard(oldDir, options) {\n  var newDir, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, _value, _value2, key, child;\n\n  return _regeneratorRuntime.async(function convertToShard$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          newDir = new DirSharded({\n            root: oldDir.root,\n            dir: true,\n            parent: oldDir.parent,\n            parentKey: oldDir.parentKey,\n            path: oldDir.path,\n            dirty: oldDir.dirty,\n            flat: false\n          }, options);\n          _iteratorNormalCompletion = true;\n          _didIteratorError = false;\n          _context.prev = 3;\n          _iterator = _asyncIterator(oldDir.eachChildSeries());\n\n        case 5:\n          _context.next = 7;\n          return _regeneratorRuntime.awrap(_iterator.next());\n\n        case 7:\n          _step = _context.sent;\n          _iteratorNormalCompletion = _step.done;\n          _context.next = 11;\n          return _regeneratorRuntime.awrap(_step.value);\n\n        case 11:\n          _value = _context.sent;\n\n          if (_iteratorNormalCompletion) {\n            _context.next = 19;\n            break;\n          }\n\n          _value2 = _value, key = _value2.key, child = _value2.child;\n          _context.next = 16;\n          return _regeneratorRuntime.awrap(newDir.put(key, child));\n\n        case 16:\n          _iteratorNormalCompletion = true;\n          _context.next = 5;\n          break;\n\n        case 19:\n          _context.next = 25;\n          break;\n\n        case 21:\n          _context.prev = 21;\n          _context.t0 = _context[\"catch\"](3);\n          _didIteratorError = true;\n          _iteratorError = _context.t0;\n\n        case 25:\n          _context.prev = 25;\n          _context.prev = 26;\n\n          if (!(!_iteratorNormalCompletion && _iterator.return != null)) {\n            _context.next = 30;\n            break;\n          }\n\n          _context.next = 30;\n          return _regeneratorRuntime.awrap(_iterator.return());\n\n        case 30:\n          _context.prev = 30;\n\n          if (!_didIteratorError) {\n            _context.next = 33;\n            break;\n          }\n\n          throw _iteratorError;\n\n        case 33:\n          return _context.finish(30);\n\n        case 34:\n          return _context.finish(25);\n\n        case 35:\n          return _context.abrupt(\"return\", newDir);\n\n        case 36:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, [[3, 21, 25, 35], [26,, 30, 34]], Promise);\n}","map":{"version":3,"sources":["C:/Users/gkhakurel/Downloads/Poject-main/Poject-main/client/node_modules/ipfs-unixfs-importer/src/flat-to-shard.js"],"names":["DirSharded","require","module","exports","child","dir","threshold","options","newDir","flat","directChildrenCount","convertToShard","parent","put","parentKey","flatToShard","oldDir","root","path","dirty","eachChildSeries","key"],"mappings":"AAAA;;;;;;;;AAEA,IAAMA,UAAU,GAAGC,OAAO,CAAC,eAAD,CAA1B;;AAEAC,MAAM,CAACC,OAAP;AAAA,8EAAiB,iBAA4BC,KAA5B,EAAmCC,GAAnC,EAAwCC,SAAxC,EAAmDC,OAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AACXC,YAAAA,MADW,GACFH,GADE;;AAAA,kBAGXA,GAAG,CAACI,IAAJ,IAAYJ,GAAG,CAACK,mBAAJ,MAA6BJ,SAH9B;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAIEK,cAAc,CAACN,GAAD,EAAME,OAAN,CAJhB;;AAAA;AAIbC,YAAAA,MAJa;;AAAA;AAOTI,YAAAA,MAPS,GAOAJ,MAAM,CAACI,MAPP;;AAAA,iBASXA,MATW;AAAA;AAAA;AAAA;;AAAA,kBAUTJ,MAAM,KAAKH,GAVF;AAAA;AAAA;AAAA;;AAWX,gBAAID,KAAJ,EAAW;AACTA,cAAAA,KAAK,CAACQ,MAAN,GAAeJ,MAAf;AACD;;AAbU;AAAA,mBAeLI,MAAM,CAACC,GAAP,CAAWL,MAAM,CAACM,SAAlB,EAA6BN,MAA7B,CAfK;;AAAA;AAAA,iBAkBTI,MAlBS;AAAA;AAAA;AAAA;;AAAA,8CAmBJG,WAAW,CAACP,MAAD,EAASI,MAAT,EAAiBN,SAAjB,EAA4BC,OAA5B,CAnBP;;AAAA;AAAA,8CAuBRC,MAvBQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAjB;;AAAA,WAAgCO,WAAhC;AAAA;AAAA;;AAAA,SAAgCA,WAAhC;AAAA;;AA0BA,SAAeJ,cAAf,CAA+BK,MAA/B,EAAuCT,OAAvC;AAAA;;AAAA;AAAA;AAAA;AAAA;AACQC,UAAAA,MADR,GACiB,IAAIR,UAAJ,CAAe;AAC5BiB,YAAAA,IAAI,EAAED,MAAM,CAACC,IADe;AAE5BZ,YAAAA,GAAG,EAAE,IAFuB;AAG5BO,YAAAA,MAAM,EAAEI,MAAM,CAACJ,MAHa;AAI5BE,YAAAA,SAAS,EAAEE,MAAM,CAACF,SAJU;AAK5BI,YAAAA,IAAI,EAAEF,MAAM,CAACE,IALe;AAM5BC,YAAAA,KAAK,EAAEH,MAAM,CAACG,KANc;AAO5BV,YAAAA,IAAI,EAAE;AAPsB,WAAf,EAQZF,OARY,CADjB;AAAA;AAAA;AAAA;AAAA,qCAWqCS,MAAM,CAACI,eAAP,EAXrC;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA,4BAWqBC,GAXrB,WAWqBA,GAXrB,EAW0BjB,KAX1B,WAW0BA,KAX1B;AAAA;AAAA,2CAYUI,MAAM,CAACK,GAAP,CAAWQ,GAAX,EAAgBjB,KAAhB,CAZV;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA,2CAeSI,MAfT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA","sourcesContent":["'use strict'\n\nconst DirSharded = require('./dir-sharded')\n\nmodule.exports = async function flatToShard (child, dir, threshold, options) {\n  let newDir = dir\n\n  if (dir.flat && dir.directChildrenCount() >= threshold) {\n    newDir = await convertToShard(dir, options)\n  }\n\n  const parent = newDir.parent\n\n  if (parent) {\n    if (newDir !== dir) {\n      if (child) {\n        child.parent = newDir\n      }\n\n      await parent.put(newDir.parentKey, newDir)\n    }\n\n    if (parent) {\n      return flatToShard(newDir, parent, threshold, options)\n    }\n  }\n\n  return newDir\n}\n\nasync function convertToShard (oldDir, options) {\n  const newDir = new DirSharded({\n    root: oldDir.root,\n    dir: true,\n    parent: oldDir.parent,\n    parentKey: oldDir.parentKey,\n    path: oldDir.path,\n    dirty: oldDir.dirty,\n    flat: false\n  }, options)\n\n  for await (const { key, child } of oldDir.eachChildSeries()) {\n    await newDir.put(key, child)\n  }\n\n  return newDir\n}\n"]},"metadata":{},"sourceType":"script"}