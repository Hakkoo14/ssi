{"ast":null,"code":"/* Copyright (c) 2013 Rod Vagg, MIT License */\nvar xtend = require('xtend'),\n    AbstractIterator = require('./abstract-iterator'),\n    AbstractChainedBatch = require('./abstract-chained-batch');\n\nfunction AbstractLevelDOWN(location) {\n  if (!arguments.length || location === undefined) throw new Error('constructor requires at least a location argument');\n  if (typeof location != 'string') throw new Error('constructor requires a location string argument');\n  this.location = location;\n  this.status = 'new';\n}\n\nAbstractLevelDOWN.prototype.open = function (options, callback) {\n  var self = this,\n      oldStatus = this.status;\n  if (typeof options == 'function') callback = options;\n  if (typeof callback != 'function') throw new Error('open() requires a callback argument');\n  if (typeof options != 'object') options = {};\n  options.createIfMissing = options.createIfMissing != false;\n  options.errorIfExists = !!options.errorIfExists;\n\n  if (typeof this._open == 'function') {\n    this.status = 'opening';\n\n    this._open(options, function (err) {\n      if (err) {\n        self.status = oldStatus;\n        return callback(err);\n      }\n\n      self.status = 'open';\n      callback();\n    });\n  } else {\n    this.status = 'open';\n    process.nextTick(callback);\n  }\n};\n\nAbstractLevelDOWN.prototype.close = function (callback) {\n  var self = this,\n      oldStatus = this.status;\n  if (typeof callback != 'function') throw new Error('close() requires a callback argument');\n\n  if (typeof this._close == 'function') {\n    this.status = 'closing';\n\n    this._close(function (err) {\n      if (err) {\n        self.status = oldStatus;\n        return callback(err);\n      }\n\n      self.status = 'closed';\n      callback();\n    });\n  } else {\n    this.status = 'closed';\n    process.nextTick(callback);\n  }\n};\n\nAbstractLevelDOWN.prototype.get = function (key, options, callback) {\n  var err;\n  if (typeof options == 'function') callback = options;\n  if (typeof callback != 'function') throw new Error('get() requires a callback argument');\n  if (err = this._checkKey(key, 'key', this._isBuffer)) return callback(err);\n  if (!this._isBuffer(key)) key = String(key);\n  if (typeof options != 'object') options = {};\n  options.asBuffer = options.asBuffer != false;\n  if (typeof this._get == 'function') return this._get(key, options, callback);\n  process.nextTick(function () {\n    callback(new Error('NotFound'));\n  });\n};\n\nAbstractLevelDOWN.prototype.put = function (key, value, options, callback) {\n  var err;\n  if (typeof options == 'function') callback = options;\n  if (typeof callback != 'function') throw new Error('put() requires a callback argument');\n  if (err = this._checkKey(key, 'key', this._isBuffer)) return callback(err);\n  if (!this._isBuffer(key)) key = String(key); // coerce value to string in node, don't touch it in browser\n  // (indexeddb can store any JS type)\n\n  if (value != null && !this._isBuffer(value) && !process.browser) value = String(value);\n  if (typeof options != 'object') options = {};\n  if (typeof this._put == 'function') return this._put(key, value, options, callback);\n  process.nextTick(callback);\n};\n\nAbstractLevelDOWN.prototype.del = function (key, options, callback) {\n  var err;\n  if (typeof options == 'function') callback = options;\n  if (typeof callback != 'function') throw new Error('del() requires a callback argument');\n  if (err = this._checkKey(key, 'key', this._isBuffer)) return callback(err);\n  if (!this._isBuffer(key)) key = String(key);\n  if (typeof options != 'object') options = {};\n  if (typeof this._del == 'function') return this._del(key, options, callback);\n  process.nextTick(callback);\n};\n\nAbstractLevelDOWN.prototype.batch = function (array, options, callback) {\n  if (!arguments.length) return this._chainedBatch();\n  if (typeof options == 'function') callback = options;\n  if (typeof array == 'function') callback = array;\n  if (typeof callback != 'function') throw new Error('batch(array) requires a callback argument');\n  if (!Array.isArray(array)) return callback(new Error('batch(array) requires an array argument'));\n  if (!options || typeof options != 'object') options = {};\n  var i = 0,\n      l = array.length,\n      e,\n      err;\n\n  for (; i < l; i++) {\n    e = array[i];\n    if (typeof e != 'object') continue;\n    if (err = this._checkKey(e.type, 'type', this._isBuffer)) return callback(err);\n    if (err = this._checkKey(e.key, 'key', this._isBuffer)) return callback(err);\n  }\n\n  if (typeof this._batch == 'function') return this._batch(array, options, callback);\n  process.nextTick(callback);\n}; //TODO: remove from here, not a necessary primitive\n\n\nAbstractLevelDOWN.prototype.approximateSize = function (start, end, callback) {\n  if (start == null || end == null || typeof start == 'function' || typeof end == 'function') {\n    throw new Error('approximateSize() requires valid `start`, `end` and `callback` arguments');\n  }\n\n  if (typeof callback != 'function') throw new Error('approximateSize() requires a callback argument');\n  if (!this._isBuffer(start)) start = String(start);\n  if (!this._isBuffer(end)) end = String(end);\n  if (typeof this._approximateSize == 'function') return this._approximateSize(start, end, callback);\n  process.nextTick(function () {\n    callback(null, 0);\n  });\n};\n\nAbstractLevelDOWN.prototype._setupIteratorOptions = function (options) {\n  var self = this;\n  options = xtend(options);\n  ['start', 'end', 'gt', 'gte', 'lt', 'lte'].forEach(function (o) {\n    if (options[o] && self._isBuffer(options[o]) && options[o].length === 0) delete options[o];\n  });\n  options.reverse = !!options.reverse;\n  options.keys = options.keys != false;\n  options.values = options.values != false;\n  options.limit = 'limit' in options ? options.limit : -1;\n  options.keyAsBuffer = options.keyAsBuffer != false;\n  options.valueAsBuffer = options.valueAsBuffer != false;\n  return options;\n};\n\nAbstractLevelDOWN.prototype.iterator = function (options) {\n  if (typeof options != 'object') options = {};\n  options = this._setupIteratorOptions(options);\n  if (typeof this._iterator == 'function') return this._iterator(options);\n  return new AbstractIterator(this);\n};\n\nAbstractLevelDOWN.prototype._chainedBatch = function () {\n  return new AbstractChainedBatch(this);\n};\n\nAbstractLevelDOWN.prototype._isBuffer = function (obj) {\n  return Buffer.isBuffer(obj);\n};\n\nAbstractLevelDOWN.prototype._checkKey = function (obj, type) {\n  if (obj === null || obj === undefined) return new Error(type + ' cannot be `null` or `undefined`');\n\n  if (this._isBuffer(obj)) {\n    if (obj.length === 0) return new Error(type + ' cannot be an empty Buffer');\n  } else if (String(obj) === '') return new Error(type + ' cannot be an empty String');\n};\n\nmodule.exports = AbstractLevelDOWN;","map":{"version":3,"sources":["D:/Poject-main/Poject-main/client/node_modules/datastore-level/node_modules/abstract-leveldown/abstract-leveldown.js"],"names":["xtend","require","AbstractIterator","AbstractChainedBatch","AbstractLevelDOWN","location","arguments","length","undefined","Error","status","prototype","open","options","callback","self","oldStatus","createIfMissing","errorIfExists","_open","err","process","nextTick","close","_close","get","key","_checkKey","_isBuffer","String","asBuffer","_get","put","value","browser","_put","del","_del","batch","array","_chainedBatch","Array","isArray","i","l","e","type","_batch","approximateSize","start","end","_approximateSize","_setupIteratorOptions","forEach","o","reverse","keys","values","limit","keyAsBuffer","valueAsBuffer","iterator","_iterator","obj","Buffer","isBuffer","module","exports"],"mappings":"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","sourcesContent":["/* Copyright (c) 2013 Rod Vagg, MIT License */\n\nvar xtend                = require('xtend')\n  , AbstractIterator     = require('./abstract-iterator')\n  , AbstractChainedBatch = require('./abstract-chained-batch')\n\nfunction AbstractLevelDOWN (location) {\n  if (!arguments.length || location === undefined)\n    throw new Error('constructor requires at least a location argument')\n\n  if (typeof location != 'string')\n    throw new Error('constructor requires a location string argument')\n\n  this.location = location\n  this.status = 'new'\n}\n\nAbstractLevelDOWN.prototype.open = function (options, callback) {\n  var self      = this\n    , oldStatus = this.status\n\n  if (typeof options == 'function')\n    callback = options\n\n  if (typeof callback != 'function')\n    throw new Error('open() requires a callback argument')\n\n  if (typeof options != 'object')\n    options = {}\n\n  options.createIfMissing = options.createIfMissing != false\n  options.errorIfExists = !!options.errorIfExists\n\n  if (typeof this._open == 'function') {\n    this.status = 'opening'\n    this._open(options, function (err) {\n      if (err) {\n        self.status = oldStatus\n        return callback(err)\n      }\n      self.status = 'open'\n      callback()\n    })\n  } else {\n    this.status = 'open'\n    process.nextTick(callback)\n  }\n}\n\nAbstractLevelDOWN.prototype.close = function (callback) {\n  var self      = this\n    , oldStatus = this.status\n\n  if (typeof callback != 'function')\n    throw new Error('close() requires a callback argument')\n\n  if (typeof this._close == 'function') {\n    this.status = 'closing'\n    this._close(function (err) {\n      if (err) {\n        self.status = oldStatus\n        return callback(err)\n      }\n      self.status = 'closed'\n      callback()\n    })\n  } else {\n    this.status = 'closed'\n    process.nextTick(callback)\n  }\n}\n\nAbstractLevelDOWN.prototype.get = function (key, options, callback) {\n  var err\n\n  if (typeof options == 'function')\n    callback = options\n\n  if (typeof callback != 'function')\n    throw new Error('get() requires a callback argument')\n\n  if (err = this._checkKey(key, 'key', this._isBuffer))\n    return callback(err)\n\n  if (!this._isBuffer(key))\n    key = String(key)\n\n  if (typeof options != 'object')\n    options = {}\n\n  options.asBuffer = options.asBuffer != false\n\n  if (typeof this._get == 'function')\n    return this._get(key, options, callback)\n\n  process.nextTick(function () { callback(new Error('NotFound')) })\n}\n\nAbstractLevelDOWN.prototype.put = function (key, value, options, callback) {\n  var err\n\n  if (typeof options == 'function')\n    callback = options\n\n  if (typeof callback != 'function')\n    throw new Error('put() requires a callback argument')\n\n  if (err = this._checkKey(key, 'key', this._isBuffer))\n    return callback(err)\n\n  if (!this._isBuffer(key))\n    key = String(key)\n\n  // coerce value to string in node, don't touch it in browser\n  // (indexeddb can store any JS type)\n  if (value != null && !this._isBuffer(value) && !process.browser)\n    value = String(value)\n\n  if (typeof options != 'object')\n    options = {}\n\n  if (typeof this._put == 'function')\n    return this._put(key, value, options, callback)\n\n  process.nextTick(callback)\n}\n\nAbstractLevelDOWN.prototype.del = function (key, options, callback) {\n  var err\n\n  if (typeof options == 'function')\n    callback = options\n\n  if (typeof callback != 'function')\n    throw new Error('del() requires a callback argument')\n\n  if (err = this._checkKey(key, 'key', this._isBuffer))\n    return callback(err)\n\n  if (!this._isBuffer(key))\n    key = String(key)\n\n  if (typeof options != 'object')\n    options = {}\n\n  if (typeof this._del == 'function')\n    return this._del(key, options, callback)\n\n  process.nextTick(callback)\n}\n\nAbstractLevelDOWN.prototype.batch = function (array, options, callback) {\n  if (!arguments.length)\n    return this._chainedBatch()\n\n  if (typeof options == 'function')\n    callback = options\n\n  if (typeof array == 'function')\n    callback = array\n\n  if (typeof callback != 'function')\n    throw new Error('batch(array) requires a callback argument')\n\n  if (!Array.isArray(array))\n    return callback(new Error('batch(array) requires an array argument'))\n\n  if (!options || typeof options != 'object')\n    options = {}\n\n  var i = 0\n    , l = array.length\n    , e\n    , err\n\n  for (; i < l; i++) {\n    e = array[i]\n    if (typeof e != 'object')\n      continue\n\n    if (err = this._checkKey(e.type, 'type', this._isBuffer))\n      return callback(err)\n\n    if (err = this._checkKey(e.key, 'key', this._isBuffer))\n      return callback(err)\n  }\n\n  if (typeof this._batch == 'function')\n    return this._batch(array, options, callback)\n\n  process.nextTick(callback)\n}\n\n//TODO: remove from here, not a necessary primitive\nAbstractLevelDOWN.prototype.approximateSize = function (start, end, callback) {\n  if (   start == null\n      || end == null\n      || typeof start == 'function'\n      || typeof end == 'function') {\n    throw new Error('approximateSize() requires valid `start`, `end` and `callback` arguments')\n  }\n\n  if (typeof callback != 'function')\n    throw new Error('approximateSize() requires a callback argument')\n\n  if (!this._isBuffer(start))\n    start = String(start)\n\n  if (!this._isBuffer(end))\n    end = String(end)\n\n  if (typeof this._approximateSize == 'function')\n    return this._approximateSize(start, end, callback)\n\n  process.nextTick(function () {\n    callback(null, 0)\n  })\n}\n\nAbstractLevelDOWN.prototype._setupIteratorOptions = function (options) {\n  var self = this\n\n  options = xtend(options)\n\n  ;[ 'start', 'end', 'gt', 'gte', 'lt', 'lte' ].forEach(function (o) {\n    if (options[o] && self._isBuffer(options[o]) && options[o].length === 0)\n      delete options[o]\n  })\n\n  options.reverse = !!options.reverse\n  options.keys = options.keys != false\n  options.values = options.values != false\n  options.limit = 'limit' in options ? options.limit : -1\n  options.keyAsBuffer = options.keyAsBuffer != false\n  options.valueAsBuffer = options.valueAsBuffer != false\n\n  return options\n}\n\nAbstractLevelDOWN.prototype.iterator = function (options) {\n  if (typeof options != 'object')\n    options = {}\n\n  options = this._setupIteratorOptions(options)\n\n  if (typeof this._iterator == 'function')\n    return this._iterator(options)\n\n  return new AbstractIterator(this)\n}\n\nAbstractLevelDOWN.prototype._chainedBatch = function () {\n  return new AbstractChainedBatch(this)\n}\n\nAbstractLevelDOWN.prototype._isBuffer = function (obj) {\n  return Buffer.isBuffer(obj)\n}\n\nAbstractLevelDOWN.prototype._checkKey = function (obj, type) {\n\n  if (obj === null || obj === undefined)\n    return new Error(type + ' cannot be `null` or `undefined`')\n\n  if (this._isBuffer(obj)) {\n    if (obj.length === 0)\n      return new Error(type + ' cannot be an empty Buffer')\n  } else if (String(obj) === '')\n    return new Error(type + ' cannot be an empty String')\n}\n\nmodule.exports = AbstractLevelDOWN\n"]},"metadata":{},"sourceType":"script"}