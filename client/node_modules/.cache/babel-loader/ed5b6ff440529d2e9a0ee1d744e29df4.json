{"ast":null,"code":"import _defineProperty from \"C:/Users/gkhakurel/Downloads/Poject-main/Poject-main/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"C:/Users/gkhakurel/Downloads/Poject-main/Poject-main/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/gkhakurel/Downloads/Poject-main/Poject-main/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"C:/Users/gkhakurel/Downloads/Poject-main/Poject-main/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:/Users/gkhakurel/Downloads/Poject-main/Poject-main/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"C:\\\\Users\\\\gkhakurel\\\\Downloads\\\\Poject-main\\\\Poject-main\\\\client\\\\src\\\\App.js\";\nimport React from 'react';\nimport './App.css';\nimport SignUp from './components/SignUp';\nimport { Redirect } from 'react-router-dom';\nimport CryptoJS from \"crypto-js\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar nacl = require(\"tweetnacl\");\n\nnacl.util = require(\"tweetnacl-util\");\n\nvar arrayBufferToHex = require(\"array-buffer-to-hex\");\n\nvar App = /*#__PURE__*/function (_React$Component) {\n  _inherits(App, _React$Component);\n\n  var _super = _createSuper(App);\n\n  function App() {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      showBackground: false,\n      showLogin: false,\n      showCreateWallet: false,\n      showVerify: false,\n      showTitleAndButtons: true,\n      signature: \"\",\n      privateKey: \"\",\n      route: false,\n      loadingCredential: false,\n      error: false,\n      errorMsg: null,\n      success: false,\n      successMsg: null\n    };\n\n    _this.renderError = function (errorMsg) {\n      _this.setState({\n        error: true,\n        errorMsg: errorMsg\n      });\n\n      setTimeout(function () {\n        _this.setState({\n          error: false\n        });\n      }, 5000);\n    };\n\n    _this.showLogin = function () {\n      _this.setState({\n        showTitleAndButtons: false,\n        showBackground: true,\n        showLogin: true\n      });\n    };\n\n    _this.handleCreateWallet = function () {\n      _this.setState({\n        showBackground: true,\n        showCreateWallet: true,\n        showTitleAndButtons: false\n      });\n    };\n\n    _this.handleLoginCut = function () {\n      _this.setState({\n        showTitleAndButtons: true,\n        showBackground: false,\n        showLogin: false\n      });\n    };\n\n    _this.handleCreateCut = function () {\n      _this.setState({\n        showBackground: false,\n        showCreateWallet: false,\n        showTitleAndButtons: true\n      });\n    };\n\n    _this.handleVerify = function () {\n      _this.setState({\n        showBackground: false,\n        showVerify: true,\n        showCreateWallet: false\n      });\n    };\n\n    _this.handleLoginChange = function (e) {\n      _this.setState(_defineProperty({}, e.target.name, e.target.value));\n    };\n\n    _this.handleFile = function (e) {\n      var fileName = e.target.files[0].name;\n      var fileExt = fileName.split('.').pop();\n\n      if (fileExt === 'txt') {\n        var privateKey = null;\n        var signature = null; // correct file extension\n\n        try {\n          var reader = new FileReader();\n\n          reader.onload = function fileReadCompleted() {\n            // when the reader is done, the content is in reader.result.\n            var result = reader.result;\n            result = result.split('\\n');\n            privateKey = result[0].split(': ').pop();\n            signature = result[2].split(': ').pop();\n          };\n\n          reader.readAsText(e.target.files[0]);\n\n          _this.setState({\n            loadingCredential: true\n          });\n\n          setTimeout(function () {\n            _this.setState({\n              privateKey: privateKey,\n              signature: signature,\n              loadingCredential: false\n            });\n          }, 2000);\n        } catch (err) {\n          _this.renderError('The selected file is corrupted.');\n        }\n      } else {\n        // wrong file\n        _this.renderError('Please select correct file');\n      }\n    };\n\n    _this.handleLogin = function (e) {\n      e.preventDefault();\n\n      if (_this.state.signature && _this.state.privateKey) {\n        // start the login process\n        try {\n          var bytes = CryptoJS.AES.decrypt(_this.state.signature, _this.state.privateKey);\n          console.log(bytes);\n          var data = JSON.parse(bytes.toString(CryptoJS.enc.Utf8));\n          console.log(data); // console.log(Buffer.from(this.state.privateKey, \"hex\"));\n          // extracting the public key from private key\n\n          var publicKey = nacl.box.keyPair.fromSecretKey(Buffer.from(_this.state.privateKey, \"hex\")).publicKey;\n          var publicHex = arrayBufferToHex(publicKey); // setting cookies\n\n          document.cookie = \"name = \".concat(data.name);\n          document.cookie = \"phone = \".concat(data.phone);\n          document.cookie = \"email = \".concat(data.email);\n          document.cookie = \"address = \".concat(data.address);\n          document.cookie = \"did = \".concat(data.did);\n          document.cookie = \"privateKey = \".concat(_this.state.privateKey);\n          document.cookie = \"publicKey = \".concat(publicHex);\n          window.location.href = \"http://localhost:3000/dashboard\";\n        } catch (error) {\n          console.log(error);\n\n          _this.renderError('Unable to log in. Please check your credentials.');\n        }\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var cookie = document.cookie; // console.log(cookie)\n\n      var value = [];\n      value[\"did\"] = null;\n\n      if (cookie) {\n        var cookieArr = cookie.split(\"; \");\n        cookieArr.forEach(function (arr) {\n          var content = arr.split(\"=\");\n          value[content[0]] = content[1]; // value.push(content[1]);\n        });\n      }\n\n      if (value['did']) {\n        this.setState({\n          route: true\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.state.route === true) {\n        return /*#__PURE__*/_jsxDEV(Redirect, {\n          to: \"/dashboard\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 16\n        }, this);\n      }\n\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"App\",\n        children: [this.state.showTitleAndButtons && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"homePageHeader\",\n            children: \"Self sovereign identity\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"btn-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"animated fadeIn login_btn\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"main_btn\",\n                onClick: this.showLogin,\n                children: \"Log In\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 171,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"animated fadeIn wallet_btn\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"main_btn\",\n                onClick: this.handleCreateWallet,\n                children: \"Create Wallet\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [this.state.showLogin && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"login-alerts\",\n              children: [this.state.error && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"alert alert-danger\",\n                style: {\n                  textTransform: \"none\"\n                },\n                children: this.state.errorMsg\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 186,\n                columnNumber: 19\n              }, this), this.state.success && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"alert alert-success\",\n                style: {\n                  textTransform: \"none\"\n                },\n                children: this.state.successMsg\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 194,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 184,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"log-in-tab\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: this.handleLoginCut,\n                className: \"open-close-button open\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n                action: \"#\",\n                className: \"log-in-form\",\n                autoComplete: \"off\",\n                children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n                  className: \"login-title\",\n                  children: \"Member Area\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 205,\n                  columnNumber: 15\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-block username-block\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"Signature\",\n                    children: \"Signature\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 207,\n                    columnNumber: 19\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    onChange: this.handleLoginChange,\n                    className: \"signup_input\",\n                    id: \"username\",\n                    type: \"text\",\n                    placeholder: \"Signature\",\n                    name: \"signature\",\n                    value: this.state.signature\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 208,\n                    columnNumber: 19\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 206,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-block password-block\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"Private Key\",\n                    children: \"Private Key\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 219,\n                    columnNumber: 19\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    onChange: this.handleLoginChange,\n                    className: \"signup_input\",\n                    id: \"password\",\n                    type: \"password\",\n                    placeholder: \"private key\",\n                    name: \"privateKey\",\n                    value: this.state.privateKey\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 220,\n                    columnNumber: 19\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 218,\n                  columnNumber: 17\n                }, this), this.state.loadingCredential ? /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-center\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"lds-facebook\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 233,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 234,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 235,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 232,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"\",\n                    children: \"loading credentials...\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 237,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 231,\n                  columnNumber: 19\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-block password-block\",\n                  style: {\n                    position: 'relative'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"app-or\",\n                    htmlFor: \"OR\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"app-line-left\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 243,\n                      columnNumber: 60\n                    }, this), \"OR\", /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"app-line-right\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 243,\n                      columnNumber: 99\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 243,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    onChange: this.handleFile,\n                    className: \"signup_input\",\n                    id: \"file\",\n                    type: \"file\",\n                    name: \"file\",\n                    style: {\n                      display: 'none'\n                    },\n                    accept: \".txt\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 244,\n                    columnNumber: 19\n                  }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"app-upload-btn\",\n                    htmlFor: \"file\",\n                    children: \"Upload credential file\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 253,\n                    columnNumber: 19\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 242,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"submit-btn\",\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: this.handleLogin,\n                    className: \"form-submit\",\n                    children: \"log in\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 257,\n                    columnNumber: 19\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 256,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 13\n          }, this), this.state.showCreateWallet && /*#__PURE__*/_jsxDEV(SignUp, {\n            handleCreateCut: this.handleCreateCut,\n            handleVerify: this.handleVerify\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 13\n          }, this), this.state.showBackground && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"background\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 41\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 7\n      }, this);\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nexport default App;","map":{"version":3,"sources":["C:/Users/gkhakurel/Downloads/Poject-main/Poject-main/client/src/App.js"],"names":["React","SignUp","Redirect","CryptoJS","nacl","require","util","arrayBufferToHex","App","state","showBackground","showLogin","showCreateWallet","showVerify","showTitleAndButtons","signature","privateKey","route","loadingCredential","error","errorMsg","success","successMsg","renderError","setState","setTimeout","handleCreateWallet","handleLoginCut","handleCreateCut","handleVerify","handleLoginChange","e","target","name","value","handleFile","fileName","files","fileExt","split","pop","reader","FileReader","onload","fileReadCompleted","result","readAsText","err","handleLogin","preventDefault","bytes","AES","decrypt","console","log","data","JSON","parse","toString","enc","Utf8","publicKey","box","keyPair","fromSecretKey","Buffer","from","publicHex","document","cookie","phone","email","address","did","window","location","href","cookieArr","forEach","arr","content","textTransform","position","display","Component"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAO,WAAP;AACA,OAAOC,MAAP,MAAmB,qBAAnB;AACA,SAAQC,QAAR,QAAuB,kBAAvB;AACA,OAAOC,QAAP,MAAqB,WAArB;;;AAEA,IAAMC,IAAI,GAAGC,OAAO,CAAC,WAAD,CAApB;;AACAD,IAAI,CAACE,IAAL,GAAYD,OAAO,CAAC,gBAAD,CAAnB;;AACA,IAAME,gBAAgB,GAAGF,OAAO,CAAC,qBAAD,CAAhC;;IAEMG,G;;;;;;;;;;;;;;;UACJC,K,GAAQ;AACNC,MAAAA,cAAc,EAAE,KADV;AAENC,MAAAA,SAAS,EAAE,KAFL;AAGNC,MAAAA,gBAAgB,EAAE,KAHZ;AAINC,MAAAA,UAAU,EAAE,KAJN;AAKNC,MAAAA,mBAAmB,EAAE,IALf;AAMNC,MAAAA,SAAS,EAAE,EANL;AAONC,MAAAA,UAAU,EAAE,EAPN;AAQNC,MAAAA,KAAK,EAAC,KARA;AASNC,MAAAA,iBAAiB,EAAC,KATZ;AAUNC,MAAAA,KAAK,EAAC,KAVA;AAWNC,MAAAA,QAAQ,EAAC,IAXH;AAYNC,MAAAA,OAAO,EAAC,KAZF;AAaNC,MAAAA,UAAU,EAAC;AAbL,K;;UAgBRC,W,GAAc,UAACH,QAAD,EAAc;AAC1B,YAAKI,QAAL,CAAc;AAACL,QAAAA,KAAK,EAAC,IAAP;AAAaC,QAAAA,QAAQ,EAARA;AAAb,OAAd;;AACAK,MAAAA,UAAU,CAAC,YAAM;AACf,cAAKD,QAAL,CAAc;AAACL,UAAAA,KAAK,EAAC;AAAP,SAAd;AACD,OAFS,EAEP,IAFO,CAAV;AAGD,K;;UACDR,S,GAAY,YAAM;AAChB,YAAKa,QAAL,CAAc;AAAEV,QAAAA,mBAAmB,EAAC,KAAtB;AAA6BJ,QAAAA,cAAc,EAAE,IAA7C;AAAmDC,QAAAA,SAAS,EAAE;AAA9D,OAAd;AACD,K;;UACDe,kB,GAAqB,YAAM;AACzB,YAAKF,QAAL,CAAc;AACZd,QAAAA,cAAc,EAAE,IADJ;AAEZE,QAAAA,gBAAgB,EAAE,IAFN;AAGZE,QAAAA,mBAAmB,EAAE;AAHT,OAAd;AAKD,K;;UACDa,c,GAAiB,YAAM;AACrB,YAAKH,QAAL,CAAc;AAAEV,QAAAA,mBAAmB,EAAC,IAAtB;AAA4BJ,QAAAA,cAAc,EAAE,KAA5C;AAAmDC,QAAAA,SAAS,EAAE;AAA9D,OAAd;AACD,K;;UACDiB,e,GAAkB,YAAM;AACtB,YAAKJ,QAAL,CAAc;AACZd,QAAAA,cAAc,EAAE,KADJ;AAEZE,QAAAA,gBAAgB,EAAE,KAFN;AAGZE,QAAAA,mBAAmB,EAAE;AAHT,OAAd;AAKD,K;;UACDe,Y,GAAe,YAAM;AACnB,YAAKL,QAAL,CAAc;AACZd,QAAAA,cAAc,EAAE,KADJ;AAEZG,QAAAA,UAAU,EAAE,IAFA;AAGZD,QAAAA,gBAAgB,EAAE;AAHN,OAAd;AAKD,K;;UACDkB,iB,GAAoB,UAAAC,CAAC,EAAI;AACvB,YAAKP,QAAL,qBAAiBO,CAAC,CAACC,MAAF,CAASC,IAA1B,EAAiCF,CAAC,CAACC,MAAF,CAASE,KAA1C;AACD,K;;UAEDC,U,GAAa,UAACJ,CAAD,EAAO;AAClB,UAAIK,QAAQ,GAAGL,CAAC,CAACC,MAAF,CAASK,KAAT,CAAe,CAAf,EAAkBJ,IAAjC;AAEA,UAAIK,OAAO,GAAGF,QAAQ,CAACG,KAAT,CAAe,GAAf,EAAoBC,GAApB,EAAd;;AACA,UAAGF,OAAO,KAAK,KAAf,EAAsB;AACpB,YAAItB,UAAU,GAAG,IAAjB;AACA,YAAID,SAAS,GAAG,IAAhB,CAFoB,CAGpB;;AACA,YAAI;AACF,cAAM0B,MAAM,GAAG,IAAIC,UAAJ,EAAf;;AACAD,UAAAA,MAAM,CAACE,MAAP,GAAgB,SAASC,iBAAT,GAA6B;AAC3C;AACA,gBAAIC,MAAM,GAAGJ,MAAM,CAACI,MAApB;AACAA,YAAAA,MAAM,GAAGA,MAAM,CAACN,KAAP,CAAa,IAAb,CAAT;AACAvB,YAAAA,UAAU,GAAG6B,MAAM,CAAC,CAAD,CAAN,CAAUN,KAAV,CAAgB,IAAhB,EAAsBC,GAAtB,EAAb;AACAzB,YAAAA,SAAS,GAAG8B,MAAM,CAAC,CAAD,CAAN,CAAUN,KAAV,CAAgB,IAAhB,EAAsBC,GAAtB,EAAZ;AACD,WAND;;AAOAC,UAAAA,MAAM,CAACK,UAAP,CAAkBf,CAAC,CAACC,MAAF,CAASK,KAAT,CAAe,CAAf,CAAlB;;AACA,gBAAKb,QAAL,CAAc;AAAEN,YAAAA,iBAAiB,EAAC;AAApB,WAAd;;AACAO,UAAAA,UAAU,CAAC,YAAM;AACf,kBAAKD,QAAL,CAAc;AAAER,cAAAA,UAAU,EAAVA,UAAF;AAAcD,cAAAA,SAAS,EAATA,SAAd;AAAyBG,cAAAA,iBAAiB,EAAC;AAA3C,aAAd;AACD,WAFS,EAEP,IAFO,CAAV;AAGD,SAdD,CAcE,OAAO6B,GAAP,EAAY;AACZ,gBAAKxB,WAAL,CAAiB,iCAAjB;AACD;AAEF,OAtBD,MAsBM;AACJ;AACA,cAAKA,WAAL,CAAiB,4BAAjB;AACD;AACF,K;;UACDyB,W,GAAc,UAACjB,CAAD,EAAO;AACnBA,MAAAA,CAAC,CAACkB,cAAF;;AAEA,UAAG,MAAKxC,KAAL,CAAWM,SAAX,IAAwB,MAAKN,KAAL,CAAWO,UAAtC,EAAiD;AAC/C;AAEA,YAAI;AACF,cAAIkC,KAAK,GAAG/C,QAAQ,CAACgD,GAAT,CAAaC,OAAb,CACV,MAAK3C,KAAL,CAAWM,SADD,EAEV,MAAKN,KAAL,CAAWO,UAFD,CAAZ;AAIAqC,UAAAA,OAAO,CAACC,GAAR,CAAYJ,KAAZ;AACA,cAAIK,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWP,KAAK,CAACQ,QAAN,CAAevD,QAAQ,CAACwD,GAAT,CAAaC,IAA5B,CAAX,CAAX;AAEAP,UAAAA,OAAO,CAACC,GAAR,CAAYC,IAAZ,EARE,CASF;AACA;;AACA,cAAIM,SAAS,GAAGzD,IAAI,CAAC0D,GAAL,CAASC,OAAT,CAAiBC,aAAjB,CACdC,MAAM,CAACC,IAAP,CAAY,MAAKzD,KAAL,CAAWO,UAAvB,EAAmC,KAAnC,CADc,EAEd6C,SAFF;AAGA,cAAIM,SAAS,GAAG5D,gBAAgB,CAACsD,SAAD,CAAhC,CAdE,CAgBF;;AAEAO,UAAAA,QAAQ,CAACC,MAAT,oBAA4Bd,IAAI,CAACtB,IAAjC;AACAmC,UAAAA,QAAQ,CAACC,MAAT,qBAA6Bd,IAAI,CAACe,KAAlC;AACAF,UAAAA,QAAQ,CAACC,MAAT,qBAA6Bd,IAAI,CAACgB,KAAlC;AACAH,UAAAA,QAAQ,CAACC,MAAT,uBAA+Bd,IAAI,CAACiB,OAApC;AACAJ,UAAAA,QAAQ,CAACC,MAAT,mBAA2Bd,IAAI,CAACkB,GAAhC;AACAL,UAAAA,QAAQ,CAACC,MAAT,0BAAkC,MAAK5D,KAAL,CAAWO,UAA7C;AACAoD,UAAAA,QAAQ,CAACC,MAAT,yBAAiCF,SAAjC;AAEAO,UAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,iCAAvB;AAED,SA5BD,CA4BE,OAAMzD,KAAN,EAAa;AACbkC,UAAAA,OAAO,CAACC,GAAR,CAAYnC,KAAZ;;AACA,gBAAKI,WAAL,CAAiB,kDAAjB;AACD;AAGF;AACF,K;;;;;;;WACD,6BAAoB;AAGlB,UAAI8C,MAAM,GAAGD,QAAQ,CAACC,MAAtB,CAHkB,CAIlB;;AACA,UAAInC,KAAK,GAAG,EAAZ;AACAA,MAAAA,KAAK,CAAC,KAAD,CAAL,GAAe,IAAf;;AACA,UAAImC,MAAJ,EAAY;AACV,YAAIQ,SAAS,GAAGR,MAAM,CAAC9B,KAAP,CAAa,IAAb,CAAhB;AAEAsC,QAAAA,SAAS,CAACC,OAAV,CAAkB,UAAAC,GAAG,EAAI;AACvB,cAAIC,OAAO,GAAGD,GAAG,CAACxC,KAAJ,CAAU,GAAV,CAAd;AACAL,UAAAA,KAAK,CAAC8C,OAAO,CAAC,CAAD,CAAR,CAAL,GAAoBA,OAAO,CAAC,CAAD,CAA3B,CAFuB,CAGvB;AACD,SAJD;AAKD;;AAED,UAAG9C,KAAK,CAAC,KAAD,CAAR,EAAgB;AACd,aAAKV,QAAL,CAAc;AAACP,UAAAA,KAAK,EAAC;AAAP,SAAd;AACD;AACF;;;WACD,kBAAS;AAEL,UAAI,KAAKR,KAAL,CAAWQ,KAAX,KAAqB,IAAzB,EAA+B;AAC7B,4BAAO,QAAC,QAAD;AAAU,UAAA,EAAE,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,gBAAP;AACD;;AACH,0BACE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA,mBACG,KAAKR,KAAL,CAAWK,mBAAX,iBACC;AAAA,kCACE;AAAK,YAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAK,YAAA,SAAS,EAAC,eAAf;AAAA,oCACE;AAAK,cAAA,SAAS,EAAC,2BAAf;AAAA,qCACE;AAAK,gBAAA,SAAS,EAAC,UAAf;AAA0B,gBAAA,OAAO,EAAE,KAAKH,SAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBADF,eAIE;AAAK,cAAA,SAAS,EAAC,4BAAf;AAAA,qCACE;AAAK,gBAAA,SAAS,EAAC,UAAf;AAA0B,gBAAA,OAAO,EAAE,KAAKe,kBAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBAJF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFJ,eAeE;AAAA,qBACG,KAAKjB,KAAL,CAAWE,SAAX,iBACC;AAAA,oCAEA;AAAM,cAAA,SAAS,EAAC,cAAhB;AAAA,yBACK,KAAKF,KAAL,CAAWU,KAAX,iBACC;AACE,gBAAA,SAAS,EAAC,oBADZ;AAEE,gBAAA,KAAK,EAAE;AAAE8D,kBAAAA,aAAa,EAAE;AAAjB,iBAFT;AAAA,0BAIG,KAAKxE,KAAL,CAAWW;AAJd;AAAA;AAAA;AAAA;AAAA,sBAFN,EASK,KAAKX,KAAL,CAAWY,OAAX,iBACC;AACE,gBAAA,SAAS,EAAC,qBADZ;AAEE,gBAAA,KAAK,EAAE;AAAE4D,kBAAAA,aAAa,EAAE;AAAjB,iBAFT;AAAA,0BAIG,KAAKxE,KAAL,CAAWa;AAJd;AAAA;AAAA;AAAA;AAAA,sBAVN;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFA,eAoBA;AAAK,cAAA,SAAS,EAAC,YAAf;AAAA,sCACE;AAAK,gBAAA,OAAO,EAAE,KAAKK,cAAnB;AAAmC,gBAAA,SAAS,EAAC;AAA7C;AAAA;AAAA;AAAA;AAAA,sBADF,eAEE;AAAM,gBAAA,MAAM,EAAC,GAAb;AAAiB,gBAAA,SAAS,EAAC,aAA3B;AAAyC,gBAAA,YAAY,EAAC,KAAtD;AAAA,wCACA;AAAI,kBAAA,SAAS,EAAC,aAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADA,eAEE;AAAK,kBAAA,SAAS,EAAC,2BAAf;AAAA,0CACE;AAAO,oBAAA,OAAO,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADF,eAEE;AACE,oBAAA,QAAQ,EAAE,KAAKG,iBADjB;AAEE,oBAAA,SAAS,EAAC,cAFZ;AAGE,oBAAA,EAAE,EAAC,UAHL;AAIE,oBAAA,IAAI,EAAC,MAJP;AAKE,oBAAA,WAAW,EAAC,WALd;AAME,oBAAA,IAAI,EAAC,WANP;AAOE,oBAAA,KAAK,EAAE,KAAKrB,KAAL,CAAWM;AAPpB;AAAA;AAAA;AAAA;AAAA,0BAFF;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFF,eAcE;AAAK,kBAAA,SAAS,EAAC,2BAAf;AAAA,0CACE;AAAO,oBAAA,OAAO,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADF,eAEE;AACE,oBAAA,QAAQ,EAAE,KAAKe,iBADjB;AAEE,oBAAA,SAAS,EAAC,cAFZ;AAGE,oBAAA,EAAE,EAAC,UAHL;AAIE,oBAAA,IAAI,EAAC,UAJP;AAKE,oBAAA,WAAW,EAAC,aALd;AAME,oBAAA,IAAI,EAAC,YANP;AAOE,oBAAA,KAAK,EAAE,KAAKrB,KAAL,CAAWO;AAPpB;AAAA;AAAA;AAAA;AAAA,0BAFF;AAAA;AAAA;AAAA;AAAA;AAAA,wBAdF,EA0BG,KAAKP,KAAL,CAAWS,iBAAX,gBACC;AAAK,kBAAA,SAAS,EAAC,aAAf;AAAA,0CACE;AAAK,oBAAA,SAAS,EAAC,cAAf;AAAA,4CACE;AAAA;AAAA;AAAA;AAAA,4BADF,eAEE;AAAA;AAAA;AAAA;AAAA,4BAFF,eAGE;AAAA;AAAA;AAAA;AAAA,4BAHF;AAAA;AAAA;AAAA;AAAA;AAAA,0BADF,eAME;AAAG,oBAAA,SAAS,EAAC,EAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BANF;AAAA;AAAA;AAAA;AAAA;AAAA,wBADD,gBAYD;AAAK,kBAAA,SAAS,EAAC,2BAAf;AAA2C,kBAAA,KAAK,EAAE;AAACgE,oBAAAA,QAAQ,EAAC;AAAV,mBAAlD;AAAA,0CACI;AAAO,oBAAA,SAAS,EAAC,QAAjB;AAA0B,oBAAA,OAAO,EAAC,IAAlC;AAAA,4CAAuC;AAAK,sBAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,4BAAvC,qBAA8E;AAAK,sBAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,4BAA9E;AAAA;AAAA;AAAA;AAAA;AAAA,0BADJ,eAEE;AACE,oBAAA,QAAQ,EAAE,KAAK/C,UADjB;AAEE,oBAAA,SAAS,EAAC,cAFZ;AAGE,oBAAA,EAAE,EAAC,MAHL;AAIE,oBAAA,IAAI,EAAC,MAJP;AAKE,oBAAA,IAAI,EAAC,MALP;AAME,oBAAA,KAAK,EAAE;AAACgD,sBAAAA,OAAO,EAAC;AAAT,qBANT;AAOE,oBAAA,MAAM,EAAC;AAPT;AAAA;AAAA;AAAA;AAAA,0BAFF,eAWE;AAAO,oBAAA,SAAS,EAAC,gBAAjB;AAAkC,oBAAA,OAAO,EAAC,MAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAXF;AAAA;AAAA;AAAA;AAAA;AAAA,wBAtCF,eAoDE;AAAK,kBAAA,SAAS,EAAC,YAAf;AAAA,yCACE;AAAQ,oBAAA,OAAO,EAAE,KAAKnC,WAAtB;AAAmC,oBAAA,SAAS,EAAC,aAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,wBApDF;AAAA;AAAA;AAAA;AAAA;AAAA,sBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,oBApBA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFJ,EAuFG,KAAKvC,KAAL,CAAWG,gBAAX,iBACC,QAAC,MAAD;AACE,YAAA,eAAe,EAAE,KAAKgB,eADxB;AAEE,YAAA,YAAY,EAAE,KAAKC;AAFrB;AAAA;AAAA;AAAA;AAAA,kBAxFJ,EA6FG,KAAKpB,KAAL,CAAWC,cAAX,iBAA6B;AAAK,YAAA,SAAS,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,kBA7FhC;AAAA;AAAA;AAAA;AAAA;AAAA,gBAfF;AAAA;AAAA;AAAA;AAAA;AAAA,cADF;AAiHD;;;;EA1QeV,KAAK,CAACoF,S;;AA6QxB,eAAe5E,GAAf","sourcesContent":["import React from 'react';\nimport './App.css';\nimport SignUp from './components/SignUp';\nimport {Redirect} from 'react-router-dom'\nimport CryptoJS from \"crypto-js\";\n\nconst nacl = require(\"tweetnacl\");\nnacl.util = require(\"tweetnacl-util\");\nconst arrayBufferToHex = require(\"array-buffer-to-hex\");\n\nclass App extends React.Component {\n  state = {\n    showBackground: false,\n    showLogin: false,\n    showCreateWallet: false,\n    showVerify: false,\n    showTitleAndButtons: true,\n    signature: \"\",\n    privateKey: \"\",\n    route:false,\n    loadingCredential:false,\n    error:false,\n    errorMsg:null,\n    success:false,\n    successMsg:null,\n  };\n\n  renderError = (errorMsg) => {\n    this.setState({error:true, errorMsg});\n    setTimeout(() => {\n      this.setState({error:false})\n    }, 5000);\n  }\n  showLogin = () => {\n    this.setState({ showTitleAndButtons:false, showBackground: true, showLogin: true });\n  };\n  handleCreateWallet = () => {\n    this.setState({\n      showBackground: true,\n      showCreateWallet: true,\n      showTitleAndButtons: false\n    });\n  };\n  handleLoginCut = () => {\n    this.setState({ showTitleAndButtons:true, showBackground: false, showLogin: false });\n  };\n  handleCreateCut = () => {\n    this.setState({\n      showBackground: false,\n      showCreateWallet: false,\n      showTitleAndButtons: true\n    });\n  };\n  handleVerify = () => {\n    this.setState({\n      showBackground: false,\n      showVerify: true,\n      showCreateWallet: false\n    });\n  };\n  handleLoginChange = e => {\n    this.setState({ [e.target.name]: e.target.value });\n  };\n\n  handleFile = (e) => {\n    let fileName = e.target.files[0].name;\n\n    let fileExt = fileName.split('.').pop();\n    if(fileExt === 'txt') {\n      let privateKey = null;\n      let signature = null;\n      // correct file extension\n      try {\n        const reader = new FileReader();\n        reader.onload = function fileReadCompleted() {\n          // when the reader is done, the content is in reader.result.\n          let result = reader.result;\n          result = result.split('\\n');\n          privateKey = result[0].split(': ').pop()\n          signature = result[2].split(': ').pop()\n        };\n        reader.readAsText(e.target.files[0]);\n        this.setState({ loadingCredential:true})\n        setTimeout(() => {\n          this.setState({ privateKey, signature, loadingCredential:false})\n        }, 2000);\n      } catch (err) {\n        this.renderError('The selected file is corrupted.');\n      }\n\n    } else{\n      // wrong file\n      this.renderError('Please select correct file');\n    }\n  }\n  handleLogin = (e) => {\n    e.preventDefault();\n\n    if(this.state.signature && this.state.privateKey){\n      // start the login process\n\n      try {\n        var bytes = CryptoJS.AES.decrypt(\n          this.state.signature,\n          this.state.privateKey\n        );\n        console.log(bytes)\n        var data = JSON.parse(bytes.toString(CryptoJS.enc.Utf8));\n\n        console.log(data);\n        // console.log(Buffer.from(this.state.privateKey, \"hex\"));\n        // extracting the public key from private key\n        let publicKey = nacl.box.keyPair.fromSecretKey(\n          Buffer.from(this.state.privateKey, \"hex\")\n        ).publicKey;\n        let publicHex = arrayBufferToHex(publicKey);\n\n        // setting cookies\n\n        document.cookie = `name = ${data.name}`;\n        document.cookie = `phone = ${data.phone}`;\n        document.cookie = `email = ${data.email}`;\n        document.cookie = `address = ${data.address}`;\n        document.cookie = `did = ${data.did}`;\n        document.cookie = `privateKey = ${this.state.privateKey}`;\n        document.cookie = `publicKey = ${publicHex}`;\n\n        window.location.href = \"http://localhost:3000/dashboard\";\n        \n      } catch(error) {\n        console.log(error)\n        this.renderError('Unable to log in. Please check your credentials.');\n      }\n\n\n    }\n  };\n  componentDidMount() {\n\n\n    let cookie = document.cookie;\n    // console.log(cookie)\n    let value = [];\n    value[\"did\"] = null;\n    if (cookie) {\n      let cookieArr = cookie.split(\"; \");\n\n      cookieArr.forEach(arr => {\n        let content = arr.split(\"=\");\n        value[content[0]] = content[1];\n        // value.push(content[1]);\n      });\n    }\n\n    if(value['did']){\n      this.setState({route:true})\n    }\n  }\n  render() {\n\n      if (this.state.route === true) {\n        return <Redirect to='/dashboard' />\n      }\n    return (\n      <div className=\"App\">\n        {this.state.showTitleAndButtons && (\n          <div>\n            <div className=\"homePageHeader\">Self sovereign identity</div>\n            <div className=\"btn-container\">\n              <div className=\"animated fadeIn login_btn\">\n                <div className=\"main_btn\" onClick={this.showLogin}>Log In</div>\n              </div>\n              <div className=\"animated fadeIn wallet_btn\">\n                <div className=\"main_btn\" onClick={this.handleCreateWallet}>Create Wallet</div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        <div>\n          {this.state.showLogin && (\n            <div>\n\n            <span className=\"login-alerts\">\n                {this.state.error && (\n                  <div\n                    className=\"alert alert-danger\"\n                    style={{ textTransform: \"none\" }}\n                  >\n                    {this.state.errorMsg}\n                  </div>\n                )}\n                {this.state.success && (\n                  <div\n                    className=\"alert alert-success\"\n                    style={{ textTransform: \"none\" }}\n                  >\n                    {this.state.successMsg}\n                  </div>\n                )}\n            </span>\n            <div className=\"log-in-tab\">\n              <div onClick={this.handleLoginCut} className=\"open-close-button open\"></div>\n              <form action=\"#\" className=\"log-in-form\" autoComplete=\"off\">\n              <h1 className=\"login-title\">Member Area</h1>\n                <div className=\"form-block username-block\">\n                  <label htmlFor=\"Signature\">Signature</label>\n                  <input\n                    onChange={this.handleLoginChange}\n                    className=\"signup_input\"\n                    id=\"username\"\n                    type=\"text\"\n                    placeholder=\"Signature\"\n                    name=\"signature\"\n                    value={this.state.signature}\n                  />\n                </div>\n                <div className=\"form-block password-block\">\n                  <label htmlFor=\"Private Key\">Private Key</label>\n                  <input\n                    onChange={this.handleLoginChange}\n                    className=\"signup_input\"\n                    id=\"password\"\n                    type=\"password\"\n                    placeholder=\"private key\"\n                    name=\"privateKey\"\n                    value={this.state.privateKey}\n                  />\n                </div>\n                {this.state.loadingCredential ? (\n                  <div className=\"text-center\">\n                    <div className=\"lds-facebook\">\n                      <div></div>\n                      <div></div>\n                      <div></div>\n                    </div>\n                    <p className=\"\">loading credentials...</p>\n                  </div>\n                )\n                \n                :                \n                <div className=\"form-block password-block\" style={{position:'relative'}}>\n                    <label className=\"app-or\" htmlFor=\"OR\"><div className=\"app-line-left\"></div>OR<div className=\"app-line-right\"></div></label>\n                  <input\n                    onChange={this.handleFile}\n                    className=\"signup_input\"\n                    id=\"file\"\n                    type=\"file\"\n                    name=\"file\"\n                    style={{display:'none'}}\n                    accept=\".txt\"\n                  />\n                  <label className=\"app-upload-btn\" htmlFor=\"file\">Upload credential file</label>\n                </div>\n                }\n                <div className=\"submit-btn\">\n                  <button onClick={this.handleLogin} className=\"form-submit\">\n                    log in\n                  </button>\n                </div>\n              </form>\n            </div>\n            </div>\n          )}\n\n\n          {this.state.showCreateWallet && (\n            <SignUp\n              handleCreateCut={this.handleCreateCut}\n              handleVerify={this.handleVerify}\n            />\n          )}\n          {this.state.showBackground && <div className=\"background\" />}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}