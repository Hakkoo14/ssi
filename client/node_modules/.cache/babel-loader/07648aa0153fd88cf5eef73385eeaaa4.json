{"ast":null,"code":"'use strict';\n\nvar Buffer = require('safe-buffer').Buffer;\n\nmodule.exports = encode;\nvar poolSize = 10 * 1024;\n\nfunction encode(opts) {\n  opts = Object.assign({\n    fixed: false\n  }, opts || {}); // Only needed for varint\n\n  var varint = require('varint');\n\n  var pool = opts.fixed ? null : createPool();\n  var used = 0;\n  var ended = false;\n  return function (read) {\n    return function (end, cb) {\n      if (end) ended = end;\n      if (ended) return cb(ended);\n      read(null, function (end, data) {\n        if (end) ended = end;\n        if (ended) return cb(ended);\n\n        if (!ended && !Buffer.isBuffer(data)) {\n          ended = new Error('data must be a buffer');\n          return cb(ended);\n        }\n\n        var dataLength = ended ? 0 : data.length;\n        var encodedLength;\n\n        if (opts.fixed) {\n          encodedLength = Buffer.alloc(4);\n          encodedLength.writeInt32BE(dataLength, 0); // writes exactly 4 bytes\n        } else {\n          varint.encode(dataLength, pool, used);\n          used += varint.encode.bytes;\n          encodedLength = pool.slice(used - varint.encode.bytes, used);\n\n          if (pool.length - used < 100) {\n            pool = createPool();\n            used = 0;\n          }\n        }\n\n        if (ended) {\n          return cb(null, encodedLength);\n        }\n\n        cb(null, Buffer.concat([encodedLength, data], (opts.fixed ? 4 : varint.encode.bytes) + dataLength));\n      });\n    };\n  };\n}\n\nfunction createPool() {\n  return Buffer.alloc(poolSize);\n}","map":{"version":3,"sources":["D:/Poject-main/Poject-main/client/node_modules/pull-length-prefixed/src/encode.js"],"names":["Buffer","require","module","exports","encode","poolSize","opts","Object","assign","fixed","varint","pool","createPool","used","ended","read","end","cb","data","isBuffer","Error","dataLength","length","encodedLength","alloc","writeInt32BE","bytes","slice","concat"],"mappings":"AAAA;;AAEA,IAAMA,MAAM,GAAGC,OAAO,CAAC,aAAD,CAAP,CAAuBD,MAAtC;;AAEAE,MAAM,CAACC,OAAP,GAAiBC,MAAjB;AAEA,IAAMC,QAAQ,GAAG,KAAK,IAAtB;;AAEA,SAASD,MAAT,CAAiBE,IAAjB,EAAuB;AACrBA,EAAAA,IAAI,GAAGC,MAAM,CAACC,MAAP,CAAc;AACnBC,IAAAA,KAAK,EAAE;AADY,GAAd,EAEJH,IAAI,IAAI,EAFJ,CAAP,CADqB,CAKrB;;AACA,MAAMI,MAAM,GAAGT,OAAO,CAAC,QAAD,CAAtB;;AACA,MAAIU,IAAI,GAAGL,IAAI,CAACG,KAAL,GAAa,IAAb,GAAoBG,UAAU,EAAzC;AACA,MAAIC,IAAI,GAAG,CAAX;AAEA,MAAIC,KAAK,GAAG,KAAZ;AAEA,SAAO,UAACC,IAAD;AAAA,WAAU,UAACC,GAAD,EAAMC,EAAN,EAAa;AAC5B,UAAID,GAAJ,EAASF,KAAK,GAAGE,GAAR;AACT,UAAIF,KAAJ,EAAW,OAAOG,EAAE,CAACH,KAAD,CAAT;AAEXC,MAAAA,IAAI,CAAC,IAAD,EAAO,UAACC,GAAD,EAAME,IAAN,EAAe;AACxB,YAAIF,GAAJ,EAASF,KAAK,GAAGE,GAAR;AACT,YAAIF,KAAJ,EAAW,OAAOG,EAAE,CAACH,KAAD,CAAT;;AAEX,YAAI,CAACA,KAAD,IAAU,CAACd,MAAM,CAACmB,QAAP,CAAgBD,IAAhB,CAAf,EAAsC;AACpCJ,UAAAA,KAAK,GAAG,IAAIM,KAAJ,CAAU,uBAAV,CAAR;AACA,iBAAOH,EAAE,CAACH,KAAD,CAAT;AACD;;AAED,YAAMO,UAAU,GAAGP,KAAK,GAAG,CAAH,GAAOI,IAAI,CAACI,MAApC;AAEA,YAAIC,aAAJ;;AACA,YAAIjB,IAAI,CAACG,KAAT,EAAgB;AACdc,UAAAA,aAAa,GAAGvB,MAAM,CAACwB,KAAP,CAAa,CAAb,CAAhB;AACAD,UAAAA,aAAa,CAACE,YAAd,CAA2BJ,UAA3B,EAAuC,CAAvC,EAFc,CAE4B;AAC3C,SAHD,MAGO;AACLX,UAAAA,MAAM,CAACN,MAAP,CAAciB,UAAd,EAA0BV,IAA1B,EAAgCE,IAAhC;AACAA,UAAAA,IAAI,IAAIH,MAAM,CAACN,MAAP,CAAcsB,KAAtB;AACAH,UAAAA,aAAa,GAAGZ,IAAI,CAACgB,KAAL,CAAWd,IAAI,GAAGH,MAAM,CAACN,MAAP,CAAcsB,KAAhC,EAAuCb,IAAvC,CAAhB;;AAEA,cAAIF,IAAI,CAACW,MAAL,GAAcT,IAAd,GAAqB,GAAzB,EAA8B;AAC5BF,YAAAA,IAAI,GAAGC,UAAU,EAAjB;AACAC,YAAAA,IAAI,GAAG,CAAP;AACD;AACF;;AAED,YAAIC,KAAJ,EAAW;AACT,iBAAOG,EAAE,CAAC,IAAD,EAAOM,aAAP,CAAT;AACD;;AAEDN,QAAAA,EAAE,CAAC,IAAD,EAAOjB,MAAM,CAAC4B,MAAP,CAAc,CACrBL,aADqB,EAErBL,IAFqB,CAAd,EAGN,CAACZ,IAAI,CAACG,KAAL,GAAa,CAAb,GAAiBC,MAAM,CAACN,MAAP,CAAcsB,KAAhC,IAAyCL,UAHnC,CAAP,CAAF;AAID,OAlCG,CAAJ;AAmCD,KAvCM;AAAA,GAAP;AAwCD;;AAED,SAAST,UAAT,GAAuB;AACrB,SAAOZ,MAAM,CAACwB,KAAP,CAAanB,QAAb,CAAP;AACD","sourcesContent":["'use strict'\n\nconst Buffer = require('safe-buffer').Buffer\n\nmodule.exports = encode\n\nconst poolSize = 10 * 1024\n\nfunction encode (opts) {\n  opts = Object.assign({\n    fixed: false\n  }, opts || {})\n\n  // Only needed for varint\n  const varint = require('varint')\n  let pool = opts.fixed ? null : createPool()\n  let used = 0\n\n  let ended = false\n\n  return (read) => (end, cb) => {\n    if (end) ended = end\n    if (ended) return cb(ended)\n\n    read(null, (end, data) => {\n      if (end) ended = end\n      if (ended) return cb(ended)\n\n      if (!ended && !Buffer.isBuffer(data)) {\n        ended = new Error('data must be a buffer')\n        return cb(ended)\n      }\n\n      const dataLength = ended ? 0 : data.length\n\n      let encodedLength\n      if (opts.fixed) {\n        encodedLength = Buffer.alloc(4)\n        encodedLength.writeInt32BE(dataLength, 0) // writes exactly 4 bytes\n      } else {\n        varint.encode(dataLength, pool, used)\n        used += varint.encode.bytes\n        encodedLength = pool.slice(used - varint.encode.bytes, used)\n\n        if (pool.length - used < 100) {\n          pool = createPool()\n          used = 0\n        }\n      }\n\n      if (ended) {\n        return cb(null, encodedLength)\n      }\n\n      cb(null, Buffer.concat([\n        encodedLength,\n        data\n      ], (opts.fixed ? 4 : varint.encode.bytes) + dataLength))\n    })\n  }\n}\n\nfunction createPool () {\n  return Buffer.alloc(poolSize)\n}\n"]},"metadata":{},"sourceType":"script"}